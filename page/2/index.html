<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Gemini","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12,"onmobile":true},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":true},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="f0.95">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="f0.95">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Raven">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false
  };
</script>

  <title>f0.95</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?502b6e1566ea20bb7678cc0d64a498cf";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">f0.95</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="search-pop-overlay">
  <div class="popup search-popup">
      <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

  </div>
</div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/winskin" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/08/2019-10-08-%E9%9D%A2%E8%AF%95%E9%A2%98-%E7%BA%BF%E7%A8%8B%E9%80%9A%E8%AE%AF-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/my-avatar.gif">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="f0.95">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/08/2019-10-08-%E9%9D%A2%E8%AF%95%E9%A2%98-%E7%BA%BF%E7%A8%8B%E9%80%9A%E8%AE%AF-1/" class="post-title-link" itemprop="url">面试题-线程通讯-1</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-10-08 14:48:53" itemprop="dateCreated datePublished" datetime="2019-10-08T14:48:53+08:00">2019-10-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-01-19 14:39:10" itemprop="dateModified" datetime="2020-01-19T14:39:10+08:00">2020-01-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%9D%A2%E8%AF%95%E9%A2%98/" itemprop="url" rel="index"><span itemprop="name">面试题</span></a>
                </span>
            </span>

          
            <span id="/2019/10/08/2019-10-08-%E9%9D%A2%E8%AF%95%E9%A2%98-%E7%BA%BF%E7%A8%8B%E9%80%9A%E8%AE%AF-1/" class="post-meta-item leancloud_visitors" data-flag-title="面试题-线程通讯-1" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2019/10/08/2019-10-08-%E9%9D%A2%E8%AF%95%E9%A2%98-%E7%BA%BF%E7%A8%8B%E9%80%9A%E8%AE%AF-1/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/10/08/2019-10-08-%E9%9D%A2%E8%AF%95%E9%A2%98-%E7%BA%BF%E7%A8%8B%E9%80%9A%E8%AE%AF-1/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="面试题目"><a href="#面试题目" class="headerlink" title="面试题目"></a>面试题目</h2><p><code>写两个线程,一个线程打印1~25,另一个线程打印字母A~Z,打印顺序为12A34B56C...5152Z,要求使用线程间的通信</code></p>
<p>来源: <a href="https://mp.weixin.qq.com/s/hKWL5EzyeLcdZ8qcjZ3wzg" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/hKWL5EzyeLcdZ8qcjZ3wzg</a></p>
<p>这是一道非常好的面试题，非常能彰显被面者关于多线程的功力，一下子就勾起了我的兴趣。这里抛砖引玉，给出7种想到的解法。</p>
<p>通用代码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> Helper &#123;<br>    instance;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> ExecutorService tPool = Executors.newFixedThreadPool(<span class="hljs-number">2</span>);<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String[] buildNoArr(<span class="hljs-keyword">int</span> max) &#123;<br>        String[] noArr = <span class="hljs-keyword">new</span> String[max];<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; max; i++) &#123;<br>            noArr[i] = Integer.toString(i + <span class="hljs-number">1</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> noArr;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String[] buildCharArr(<span class="hljs-keyword">int</span> max) &#123;<br>        String[] charArr = <span class="hljs-keyword">new</span> String[max];<br>        <span class="hljs-keyword">int</span> tmp = <span class="hljs-number">65</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; max; i++) &#123;<br>            charArr[i] = String.valueOf((<span class="hljs-keyword">char</span>) (tmp + i));<br>        &#125;<br>        <span class="hljs-keyword">return</span> charArr;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">print</span><span class="hljs-params">(String... input)</span> </span>&#123;<br>        <span class="hljs-keyword">if</span> (input == <span class="hljs-keyword">null</span>)<br>            <span class="hljs-keyword">return</span>;<br>        <span class="hljs-keyword">for</span> (String each : input) &#123;<br>            System.out.print(each);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">(Runnable r)</span> </span>&#123;<br>        tPool.submit(r);<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">shutdown</span><span class="hljs-params">()</span> </span>&#123;<br>        tPool.shutdown();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="1-变量控制"><a href="#1-变量控制" class="headerlink" title="1. 变量控制"></a>1. 变量控制</h2><p>第一种解法，包含多种小的不同实现方式，但一个共同点就是靠一个共享变量来做控制。</p>
<h3 id="1-用最基本的synchronized、notify、wait"><a href="#1-用最基本的synchronized、notify、wait" class="headerlink" title="1) 用最基本的synchronized、notify、wait"></a>1) 用最基本的<font color=red face="Cascadia Code"><code>synchronized、notify、wait</code></font></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MethodOne</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ThreadToGo threadToGo = <span class="hljs-keyword">new</span> ThreadToGo();<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String args[])</span> <span class="hljs-keyword">throws</span> InterruptedException </span>&#123;<br>        MethodOne one = <span class="hljs-keyword">new</span> MethodOne();<br>        Helper.instance.run(one.newThreadOne());<br>        Helper.instance.run(one.newThreadTwo());<br>        Helper.instance.shutdown();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Runnable <span class="hljs-title">newThreadOne</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">final</span> String[] inputArr = Helper.buildNoArr(<span class="hljs-number">52</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Runnable() &#123;<br>            <span class="hljs-keyword">private</span> String[] arr = inputArr;<br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i = i + <span class="hljs-number">2</span>) &#123;<br>                        <span class="hljs-keyword">synchronized</span> (threadToGo) &#123;<br>                            <span class="hljs-keyword">while</span> (threadToGo.value == <span class="hljs-number">2</span>)<br>                                threadToGo.wait();<br>                            Helper.print(arr[i], arr[i + <span class="hljs-number">1</span>]);<br>                            threadToGo.value = <span class="hljs-number">2</span>;<br>                            threadToGo.notify();<br>                        &#125;<br>                    &#125;<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    System.out.println(<span class="hljs-string">"Oops..."</span>);<br>                &#125;<br>            &#125;<br>        &#125;;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Runnable <span class="hljs-title">newThreadTwo</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">final</span> String[] inputArr = Helper.buildCharArr(<span class="hljs-number">26</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Runnable() &#123;<br>            <span class="hljs-keyword">private</span> String[] arr = inputArr;<br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>                <span class="hljs-keyword">try</span> &#123;<br>                    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) &#123;<br>                        <span class="hljs-keyword">synchronized</span> (threadToGo) &#123;<br>                            <span class="hljs-keyword">while</span> (threadToGo.value == <span class="hljs-number">1</span>)<br>                                threadToGo.wait();<br>                            Helper.print(arr[i]);<br>                            threadToGo.value = <span class="hljs-number">1</span>;<br>                            threadToGo.notify();<br>                        &#125;<br>                    &#125;<br>                &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                    System.out.println(<span class="hljs-string">"Oops..."</span>);<br>                &#125;<br>            &#125;<br>        &#125;;<br>    &#125;<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ThreadToGo</span> </span>&#123;<br>        <span class="hljs-keyword">int</span> value = <span class="hljs-number">1</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="2-利用-Lock和Condition"><a href="#2-利用-Lock和Condition" class="headerlink" title="2) 利用 Lock和Condition"></a>2) 利用 <font color=red face="Cascadia Code"><code>Lock</code>和<code>Condition</code></font></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MethodTwo</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ThreadToGo threadToGo = <span class="hljs-keyword">new</span> ThreadToGo();<br>    <span class="hljs-keyword">private</span> Lock lock = <span class="hljs-keyword">new</span> ReentrantLock(<span class="hljs-keyword">true</span>);<br>    <span class="hljs-keyword">private</span> Condition condition = lock.newCondition();<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String args[])</span> <span class="hljs-keyword">throws</span> InterruptedException </span>&#123;<br>        MethodTwo two = <span class="hljs-keyword">new</span> MethodTwo();<br>        Helper.instance.run(two.newThreadOne());<br>        Helper.instance.run(two.newThreadTwo());<br>        Helper.instance.shutdown();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Runnable <span class="hljs-title">newThreadOne</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">final</span> String[] inputArr = Helper.buildNoArr(<span class="hljs-number">52</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Runnable() &#123;<br>            <span class="hljs-keyword">private</span> String[] arr = inputArr;<br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i = i + <span class="hljs-number">2</span>) &#123;<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        lock.lock();<br>                        <span class="hljs-keyword">while</span> (threadToGo.value == <span class="hljs-number">2</span>)<br>                            condition.await();<br>                        Helper.print(arr[i], arr[i + <span class="hljs-number">1</span>]);<br>                        threadToGo.value = <span class="hljs-number">2</span>;<br>                        condition.signal();<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                        e.printStackTrace();<br>                    &#125; <span class="hljs-keyword">finally</span> &#123;<br>                        lock.unlock();<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Runnable <span class="hljs-title">newThreadTwo</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">final</span> String[] inputArr = Helper.buildCharArr(<span class="hljs-number">26</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Runnable() &#123;<br>            <span class="hljs-keyword">private</span> String[] arr = inputArr;<br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) &#123;<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        lock.lock();<br>                        <span class="hljs-keyword">while</span> (threadToGo.value == <span class="hljs-number">1</span>)<br>                            condition.await();<br>                        Helper.print(arr[i]);<br>                        threadToGo.value = <span class="hljs-number">1</span>;<br>                        condition.signal();<br>                    &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>                        e.printStackTrace();<br>                    &#125; <span class="hljs-keyword">finally</span> &#123;<br>                        lock.unlock();<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;;<br>    &#125;<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ThreadToGo</span> </span>&#123;<br>        <span class="hljs-keyword">int</span> value = <span class="hljs-number">1</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="3-利用-volatile"><a href="#3-利用-volatile" class="headerlink" title="3) 利用 volatile"></a>3) 利用 <font color=red face="Cascadia Code"><code>volatile</code></font></h3><p><code>volatile</code>修饰的变量值直接存在main memory里面，子线程对该变量的读写直接写入main memory，而不是像其它变量一样在local thread里面产生一份copy。<code>volatile</code>能保证所修饰的变量对于多个线程可见性，即只要被修改，其它线程读到的一定是最新的值。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java">        <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MethodThree</span> </span>&#123;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">volatile</span> ThreadToGo threadToGo = <span class="hljs-keyword">new</span> ThreadToGo();<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ThreadToGo</span> </span>&#123;<br>    <span class="hljs-keyword">int</span> value = <span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> Runnable <span class="hljs-title">newThreadOne</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">final</span> String[] inputArr = Helper.buildNoArr(<span class="hljs-number">52</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Runnable() &#123;<br>    <span class="hljs-keyword">private</span> String[] arr = inputArr;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i=i+<span class="hljs-number">2</span>) &#123;<br>        <span class="hljs-keyword">while</span>(threadToGo.value==<span class="hljs-number">2</span>)&#123;&#125;<br>        Helper.print(arr[i], arr[i + <span class="hljs-number">1</span>]);<br>        threadToGo.value=<span class="hljs-number">2</span>;<br>        &#125;<br>    &#125;<br>    &#125;;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> Runnable <span class="hljs-title">newThreadTwo</span><span class="hljs-params">()</span> </span>&#123;<br><span class="hljs-keyword">final</span> String[] inputArr = Helper.buildCharArr(<span class="hljs-number">26</span>);<br><span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Runnable() &#123;<br>    <span class="hljs-keyword">private</span> String[] arr = inputArr;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) &#123;<br>        <span class="hljs-keyword">while</span>(threadToGo.value==<span class="hljs-number">1</span>)&#123;&#125;<br>        Helper.print(arr[i]);<br>        threadToGo.value=<span class="hljs-number">1</span>;<br>        &#125;<br>    &#125;<br>    &#125;;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String args[])</span> <span class="hljs-keyword">throws</span> InterruptedException </span>&#123;<br>    MethodThree three = <span class="hljs-keyword">new</span> MethodThree();<br>    Helper.instance.run(three.newThreadOne());<br>    Helper.instance.run(three.newThreadTwo());<br>    Helper.instance.shutdown();<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="4-利用-AtomicInteger"><a href="#4-利用-AtomicInteger" class="headerlink" title="4) 利用 AtomicInteger"></a>4) 利用 <font color=red face="Cascadia Code"><code>AtomicInteger</code></font></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MethodFive</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> AtomicInteger threadToGo = <span class="hljs-keyword">new</span> AtomicInteger(<span class="hljs-number">1</span>);<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Runnable <span class="hljs-title">newThreadOne</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">final</span> String[] inputArr = Helper.buildNoArr(<span class="hljs-number">52</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Runnable() &#123;<br>            <span class="hljs-keyword">private</span> String[] arr = inputArr;<br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i=i+<span class="hljs-number">2</span>) &#123;<br>                    <span class="hljs-keyword">while</span>(threadToGo.get()==<span class="hljs-number">2</span>)&#123;&#125;<br>                    Helper.print(arr[i], arr[i + <span class="hljs-number">1</span>]);<br>                    threadToGo.set(<span class="hljs-number">2</span>);<br>                &#125;<br>            &#125;<br>        &#125;;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Runnable <span class="hljs-title">newThreadTwo</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">final</span> String[] inputArr = Helper.buildCharArr(<span class="hljs-number">26</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Runnable() &#123;<br>            <span class="hljs-keyword">private</span> String[] arr = inputArr;<br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) &#123;<br>                    <span class="hljs-keyword">while</span>(threadToGo.get()==<span class="hljs-number">1</span>)&#123;&#125;<br>                    Helper.print(arr[i]);<br>                    threadToGo.set(<span class="hljs-number">1</span>);<br>                &#125;<br>            &#125;<br>        &#125;;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String args[])</span> <span class="hljs-keyword">throws</span> InterruptedException </span>&#123;<br>        MethodFive five = <span class="hljs-keyword">new</span> MethodFive();<br>        Helper.instance.run(five.newThreadOne());<br>        Helper.instance.run(five.newThreadTwo());<br>        Helper.instance.shutdown();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="2-CyclicBarrierAPI"><a href="#2-CyclicBarrierAPI" class="headerlink" title="2. CyclicBarrierAPI"></a>2. <code>CyclicBarrierAPI</code></h2><p><code>CyclicBarrier</code>可以实现让一组线程在全部到达<code>Barrier</code>时(执行<code>await()</code>)，再一起同时执行，并且所有线程释放后，还能复用它,即为<code>Cyclic</code>。</p>
<p><code>CyclicBarrier</code>类提供两个构造器：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CyclicBarrier</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CyclicBarrier</span><span class="hljs-params">(<span class="hljs-keyword">int</span> parties, Runnable barrierAction)</span> </span>&#123;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CyclicBarrier</span><span class="hljs-params">(<span class="hljs-keyword">int</span> parties)</span> </span>&#123;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MethodFour</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> CyclicBarrier barrier;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> List&lt;String&gt; list;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MethodFour</span><span class="hljs-params">()</span> </span>&#123;<br>        list = Collections.synchronizedList(<span class="hljs-keyword">new</span> ArrayList&lt;String&gt;());<br>        barrier = <span class="hljs-keyword">new</span> CyclicBarrier(<span class="hljs-number">2</span>,newBarrierAction());<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Runnable <span class="hljs-title">newThreadOne</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">final</span> String[] inputArr = Helper.buildNoArr(<span class="hljs-number">52</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Runnable() &#123;<br>            <span class="hljs-keyword">private</span> String[] arr = inputArr;<br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>, j=<span class="hljs-number">0</span>; i &lt; arr.length; i=i+<span class="hljs-number">2</span>,j++) &#123;<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        list.add(arr[i]);<br>                        list.add(arr[i+<span class="hljs-number">1</span>]);<br>                        barrier.await();<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException | BrokenBarrierException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Runnable <span class="hljs-title">newThreadTwo</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">final</span> String[] inputArr = Helper.buildCharArr(<span class="hljs-number">26</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Runnable() &#123;<br>            <span class="hljs-keyword">private</span> String[] arr = inputArr;<br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) &#123;<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        list.add(arr[i]);<br>                        barrier.await();<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException | BrokenBarrierException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">private</span> Runnable <span class="hljs-title">newBarrierAction</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Runnable() &#123;<br>            <span class="hljs-meta">@Override</span><br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>                Collections.sort(list);<br>                list.forEach(c-&gt;System.out.print(c));<br>                list.clear();<br>            &#125;<br>        &#125;;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String args[])</span></span>&#123;<br>        MethodFour four = <span class="hljs-keyword">new</span> MethodFour();<br>        Helper.instance.run(four.newThreadOne());<br>        Helper.instance.run(four.newThreadTwo());<br>        Helper.instance.shutdown();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这里多说一点，这个API其实还是利用<code>lock</code>和<code>condition</code>，无非是多个线程去争抢<code>CyclicBarrier</code>的<code>instance的lock</code>罢了，最终<code>barrierAction</code>执行时，是在抢到<code>CyclicBarrierinstance</code>的那个线程上执行的。</p>
<h2 id="3-PipedInputStreamAPI"><a href="#3-PipedInputStreamAPI" class="headerlink" title="3. PipedInputStreamAPI"></a>3. <code>PipedInputStreamAPI</code></h2><p>这里用流在两个线程间通信，但是Java中的Stream是单向的，所以在两个线程中分别建了一个input和output。这显然是一种很搓的方式，不过也算是一种通信方式吧，执行的时候那种速度简直。。。。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MethodSix</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> PipedInputStream inputStream1;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> PipedOutputStream outputStream1;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> PipedInputStream inputStream2;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> PipedOutputStream outputStream2;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">byte</span>[] MSG;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MethodSix</span><span class="hljs-params">()</span> </span>&#123;<br>        inputStream1 = <span class="hljs-keyword">new</span> PipedInputStream();<br>        outputStream1 = <span class="hljs-keyword">new</span> PipedOutputStream();<br>        inputStream2 = <span class="hljs-keyword">new</span> PipedInputStream();<br>        outputStream2 = <span class="hljs-keyword">new</span> PipedOutputStream();<br>        MSG = <span class="hljs-string">"Go"</span>.getBytes();<br>        <span class="hljs-keyword">try</span> &#123;<br>            inputStream1.connect(outputStream2);<br>            inputStream2.connect(outputStream1);<br>        &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">shutdown</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        inputStream1.close();<br>        inputStream2.close();<br>        outputStream1.close();<br>        outputStream2.close();<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Runnable <span class="hljs-title">newThreadOne</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">final</span> String[] inputArr = Helper.buildNoArr(<span class="hljs-number">52</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Runnable() &#123;<br>            <span class="hljs-keyword">private</span> String[] arr = inputArr;<br>            <span class="hljs-keyword">private</span> PipedInputStream in = inputStream1;<br>            <span class="hljs-keyword">private</span> PipedOutputStream out = outputStream1;<br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i = i + <span class="hljs-number">2</span>) &#123;<br>                    Helper.print(arr[i], arr[i + <span class="hljs-number">1</span>]);<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        out.write(MSG);<br>                        <span class="hljs-keyword">byte</span>[] inArr = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[<span class="hljs-number">2</span>];<br>                        in.read(inArr);<br>                        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;<br>                            <span class="hljs-keyword">if</span> (<span class="hljs-string">"Go"</span>.equals(<span class="hljs-keyword">new</span> String(inArr)))<br>                                <span class="hljs-keyword">break</span>;<br>                        &#125;<br>                    &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Runnable <span class="hljs-title">newThreadTwo</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">final</span> String[] inputArr = Helper.buildCharArr(<span class="hljs-number">26</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Runnable() &#123;<br>            <span class="hljs-keyword">private</span> String[] arr = inputArr;<br>            <span class="hljs-keyword">private</span> PipedInputStream in = inputStream2;<br>            <span class="hljs-keyword">private</span> PipedOutputStream out = outputStream2;<br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) &#123;<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        <span class="hljs-keyword">byte</span>[] inArr = <span class="hljs-keyword">new</span> <span class="hljs-keyword">byte</span>[<span class="hljs-number">2</span>];<br>                        in.read(inArr);<br>                        <span class="hljs-keyword">while</span> (<span class="hljs-keyword">true</span>) &#123;<br>                            <span class="hljs-keyword">if</span> (<span class="hljs-string">"Go"</span>.equals(<span class="hljs-keyword">new</span> String(inArr)))<br>                                <span class="hljs-keyword">break</span>;<br>                        &#125;<br>                        Helper.print(arr[i]);<br>                        out.write(MSG);<br>                    &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String args[])</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;<br>        MethodSix six = <span class="hljs-keyword">new</span> MethodSix();<br>        Helper.instance.run(six.newThreadOne());<br>        Helper.instance.run(six.newThreadTwo());<br>        Helper.instance.shutdown();<br>        six.shutdown();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="4-BlockingQueue"><a href="#4-BlockingQueue" class="headerlink" title="4. BlockingQueue"></a>4. <code>BlockingQueue</code></h2><h3 id="顺便总结下BlockingQueue的一些内容"><a href="#顺便总结下BlockingQueue的一些内容" class="headerlink" title="顺便总结下BlockingQueue的一些内容"></a>顺便总结下<code>BlockingQueue</code>的一些内容</h3><p><font color=red face="Cascadia Code">BlockingQueue</font>定义的常用方法如下:</p>
<ul>
<li><code>add(Object)</code>：把<code>Object</code>加到<code>BlockingQueue</code>里，如果<code>BlockingQueue</code>可以容纳，则返回<code>true</code>，否则抛出异常。</li>
<li><code>offer(Object)</code>：表示如果可能的话，将<code>Object</code>加到<code>BlockingQueue</code>里，即如果<code>BlockingQueue</code>可以容纳，则返回<code>true</code>，否则返回<code>false</code>。</li>
<li><code>put(Object)</code>：把<code>Object</code>加到<code>BlockingQueue</code>里，如果<code>BlockingQueue</code>没有空间，则调用此方法的线程被阻断直到<code>BlockingQueue</code>里有空间再继续。</li>
<li><code>poll(time)</code>：获取并删除<code>BlockingQueue</code>里排在首位的对象，若不能立即取出，则可以等<code>time</code>参数规定的时间，取不到时返回<code>null</code>。当不传入<code>time</code>值时，立刻返回。</li>
<li><code>peek()</code>：立刻获取<code>BlockingQueue</code>里排在首位的对象，但不从队列里删除，如果队列为空，则返回<code>null</code>。</li>
<li><code>take()</code>：获取并删除<code>BlockingQueue</code>里排在首位的对象，若<code>BlockingQueue</code>为空，阻断进入等待状态直到<code>BlockingQueue</code>有新的对象被加入为止。</li>
</ul>
<p><font color=red face="Cascadia Code">BlockingQueue</font>有四个具体的实现类：</p>
<ul>
<li><code>ArrayBlockingQueue</code>：规定大小的<code>BlockingQueue</code>，其构造函数必须带一个<code>int</code>参数来指明其大小。其所含的对象是以<code>FIFO</code>（先入先出）顺序排序的。</li>
<li><code>LinkedBlockingQueue</code>：大小不定的<code>BlockingQueue</code>，若其构造函数带一个规定大小的参数，生成的<code>BlockingQueue</code>有大小限制，若不带大小参数，所生成的<code>BlockingQueue</code>的大小由<code>Integer.MAX_VALUE</code>来决定。其所含的对象是以<code>FIFO</code>顺序排序的。</li>
<li><code>PriorityBlockingQueue</code>：类似于<code>LinkedBlockingQueue</code>,但其所含对象的排序不是<code>FIFO</code>，而是依据对象的自然排序顺序或者是构造函数所带的<code>Comparator</code>决定的顺序。</li>
<li><code>SynchronousQueue</code>：特殊的<code>BlockingQueue</code>，对其的操作必须是放和取交替完成的。</li>
</ul>
<h3 id="这里用了两种玩法"><a href="#这里用了两种玩法" class="headerlink" title="这里用了两种玩法"></a>这里用了两种玩法</h3><p>1) 共享一个<code>queue</code>，根据<code>peek</code>和<code>poll</code>的不同来实现<br>2)两个<code>queue</code>，利用<code>take()</code>会自动阻塞来实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><code class="hljs java"><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MethodSeven</span> </span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> LinkedBlockingQueue&lt;String&gt; queue = <span class="hljs-keyword">new</span> LinkedBlockingQueue&lt;&gt;();<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Runnable <span class="hljs-title">newThreadOne</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">final</span> String[] inputArr = Helper.buildNoArr(<span class="hljs-number">52</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Runnable() &#123;<br>            <span class="hljs-keyword">private</span> String[] arr = inputArr;<br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i = i + <span class="hljs-number">2</span>) &#123;<br>                    Helper.print(arr[i], arr[i + <span class="hljs-number">1</span>]);<br>                    queue.offer(<span class="hljs-string">"TwoToGo"</span>);<br>                    <span class="hljs-keyword">while</span> (!<span class="hljs-string">"OneToGo"</span>.equals(queue.peek())) &#123;<br>                    &#125;<br>                    queue.poll();<br>                &#125;<br>            &#125;<br>        &#125;;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Runnable <span class="hljs-title">newThreadTwo</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">final</span> String[] inputArr = Helper.buildCharArr(<span class="hljs-number">26</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Runnable() &#123;<br>            <span class="hljs-keyword">private</span> String[] arr = inputArr;<br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) &#123;<br>                    <span class="hljs-keyword">while</span> (!<span class="hljs-string">"TwoToGo"</span>.equals(queue.peek())) &#123;<br>                    &#125;<br>                    queue.poll();<br>                    Helper.print(arr[i]);<br>                    queue.offer(<span class="hljs-string">"OneToGo"</span>);<br>                &#125;<br>            &#125;<br>        &#125;;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> LinkedBlockingQueue&lt;String&gt; queue1 = <span class="hljs-keyword">new</span> LinkedBlockingQueue&lt;&gt;();<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> LinkedBlockingQueue&lt;String&gt; queue2 = <span class="hljs-keyword">new</span> LinkedBlockingQueue&lt;&gt;();<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Runnable <span class="hljs-title">newThreadThree</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">final</span> String[] inputArr = Helper.buildNoArr(<span class="hljs-number">52</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Runnable() &#123;<br>            <span class="hljs-keyword">private</span> String[] arr = inputArr;<br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i = i + <span class="hljs-number">2</span>) &#123;<br>                    Helper.print(arr[i], arr[i + <span class="hljs-number">1</span>]);<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        queue2.put(<span class="hljs-string">"TwoToGo"</span>);<br>                        queue1.take();<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Runnable <span class="hljs-title">newThreadFour</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">final</span> String[] inputArr = Helper.buildCharArr(<span class="hljs-number">26</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Runnable() &#123;<br>            <span class="hljs-keyword">private</span> String[] arr = inputArr;<br>            <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">run</span><span class="hljs-params">()</span> </span>&#123;<br>                <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) &#123;<br>                    <span class="hljs-keyword">try</span> &#123;<br>                        queue2.take();<br>                        Helper.print(arr[i]);<br>                        queue1.put(<span class="hljs-string">"OneToGo"</span>);<br>                    &#125; <span class="hljs-keyword">catch</span> (InterruptedException e) &#123;<br>                        e.printStackTrace();<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String args[])</span> <span class="hljs-keyword">throws</span> InterruptedException </span>&#123;<br>        MethodSeven seven = <span class="hljs-keyword">new</span> MethodSeven();<br>        Helper.instance.run(seven.newThreadOne());<br>        Helper.instance.run(seven.newThreadTwo());<br>        Thread.sleep(<span class="hljs-number">2000</span>);<br>        System.out.println(<span class="hljs-string">""</span>);<br>        Helper.instance.run(seven.newThreadThree());<br>        Helper.instance.run(seven.newThreadFour());<br>        Helper.instance.shutdown();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/07/2019-09-07-%E9%9D%A2%E8%AF%95%E9%A2%98%E5%85%88%E8%B5%8B%E5%80%BC%E5%90%8E%E8%87%AA%E5%A2%9E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/my-avatar.gif">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="f0.95">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/09/07/2019-09-07-%E9%9D%A2%E8%AF%95%E9%A2%98%E5%85%88%E8%B5%8B%E5%80%BC%E5%90%8E%E8%87%AA%E5%A2%9E/" class="post-title-link" itemprop="url">面试题-先赋值后自增</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-07 17:56:10" itemprop="dateCreated datePublished" datetime="2019-09-07T17:56:10+08:00">2019-09-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-01-19 14:39:23" itemprop="dateModified" datetime="2020-01-19T14:39:23+08:00">2020-01-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%9D%A2%E8%AF%95%E9%A2%98/" itemprop="url" rel="index"><span itemprop="name">面试题</span></a>
                </span>
            </span>

          
            <span id="/2019/09/07/2019-09-07-%E9%9D%A2%E8%AF%95%E9%A2%98%E5%85%88%E8%B5%8B%E5%80%BC%E5%90%8E%E8%87%AA%E5%A2%9E/" class="post-meta-item leancloud_visitors" data-flag-title="面试题-先赋值后自增" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2019/09/07/2019-09-07-%E9%9D%A2%E8%AF%95%E9%A2%98%E5%85%88%E8%B5%8B%E5%80%BC%E5%90%8E%E8%87%AA%E5%A2%9E/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/09/07/2019-09-07-%E9%9D%A2%E8%AF%95%E9%A2%98%E5%85%88%E8%B5%8B%E5%80%BC%E5%90%8E%E8%87%AA%E5%A2%9E/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BadCode</span> </span>&#123;<br>	<span class="hljs-comment">/**<br>	* 计算总数<br>	*/</span><br>	<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">countDemo</span><span class="hljs-params">()</span></span>&#123;<br>		<span class="hljs-keyword">int</span> num = <span class="hljs-number">0</span>;<br>		<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">100</span>;i++)&#123;<br>			num = num ++;<br>			<span class="hljs-comment">/**<br>			* do something<br>			*/</span><br>		&#125;<br>		System.out.println(num);<br>	&#125;<br>	<span class="hljs-comment">/**<br>	* 输出结果：num=0<br>	* 然后 我叫了个大神来我帮我分析下。囧<br>	*/</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="解释"><a href="#解释" class="headerlink" title="解释"></a>解释</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">i++ :<br>	temp = i ;<br>	i = i + <span class="hljs-number">1</span>;<br>	i = temp;<br></code></pre></td></tr></table></figure>

<p>so in “n = n ++;”, n always equals temp ， always equals 0；</p>
<p>说明了“先赋值后自增”有问题，或许是理解问题或许是表述问题，也可能是实现问题。<br>赋值给自身，导致无法自增。<br>另外，反汇编发现自增操作好像发生在赋值操作之前。</p>
<p>是的，自增是发生在赋值之前，但是赋值的时候不是取的自增后的值。<br>（应该是产生了一个中间变量，javap 可以查看class 字节码）</p>
<p>来自 <a href="https://gitee.com/oschina/bullshit-codes/blob/master/java/BadCode.java" target="_blank" rel="noopener">https://gitee.com/oschina/bullshit-codes/blob/master/java/BadCode.java</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/07/2019-09-07-%E9%9D%A2%E8%AF%95%E9%A2%98IntegerCache%20copy/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/my-avatar.gif">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="f0.95">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/09/07/2019-09-07-%E9%9D%A2%E8%AF%95%E9%A2%98IntegerCache%20copy/" class="post-title-link" itemprop="url">面试题-IntegerCache</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-07 17:55:57" itemprop="dateCreated datePublished" datetime="2019-09-07T17:55:57+08:00">2019-09-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-01-19 14:39:19" itemprop="dateModified" datetime="2020-01-19T14:39:19+08:00">2020-01-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%9D%A2%E8%AF%95%E9%A2%98/" itemprop="url" rel="index"><span itemprop="name">面试题</span></a>
                </span>
            </span>

          
            <span id="/2019/09/07/2019-09-07-%E9%9D%A2%E8%AF%95%E9%A2%98IntegerCache%20copy/" class="post-meta-item leancloud_visitors" data-flag-title="面试题-IntegerCache" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2019/09/07/2019-09-07-%E9%9D%A2%E8%AF%95%E9%A2%98IntegerCache%20copy/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/09/07/2019-09-07-%E9%9D%A2%E8%AF%95%E9%A2%98IntegerCache%20copy/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="题目-Integer-比较200是否等于200"><a href="#题目-Integer-比较200是否等于200" class="headerlink" title="题目: Integer 比较200是否等于200"></a>题目: <code>Integer</code> 比较200是否等于200</h2><ol>
<li><code>IntegerCache</code>的缓存值范围默认-128-127(可以用<code>JVM</code>命令参数调整)</li>
<li><code>Integer</code>比较使用<code>equals()</code>, 因为使用==比较只能用于-128-127的范围</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/07/2019-09-07-%E8%84%8F%E8%AF%BB,%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB,%E5%B9%BB%E8%AF%BB%20-%20%E5%89%AF%E6%9C%AC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/my-avatar.gif">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="f0.95">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/09/07/2019-09-07-%E8%84%8F%E8%AF%BB,%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB,%E5%B9%BB%E8%AF%BB%20-%20%E5%89%AF%E6%9C%AC/" class="post-title-link" itemprop="url">脏读,不可重复读,幻读</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-07 16:52:13" itemprop="dateCreated datePublished" datetime="2019-09-07T16:52:13+08:00">2019-09-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-01-19 14:39:14" itemprop="dateModified" datetime="2020-01-19T14:39:14+08:00">2020-01-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%B0%E5%BD%95/" itemprop="url" rel="index"><span itemprop="name">记录</span></a>
                </span>
            </span>

          
            <span id="/2019/09/07/2019-09-07-%E8%84%8F%E8%AF%BB,%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB,%E5%B9%BB%E8%AF%BB%20-%20%E5%89%AF%E6%9C%AC/" class="post-meta-item leancloud_visitors" data-flag-title="脏读,不可重复读,幻读" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2019/09/07/2019-09-07-%E8%84%8F%E8%AF%BB,%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB,%E5%B9%BB%E8%AF%BB%20-%20%E5%89%AF%E6%9C%AC/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/09/07/2019-09-07-%E8%84%8F%E8%AF%BB,%E4%B8%8D%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB,%E5%B9%BB%E8%AF%BB%20-%20%E5%89%AF%E6%9C%AC/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="spring-数据库-事务隔离级别分为四种-级别递减"><a href="#spring-数据库-事务隔离级别分为四种-级别递减" class="headerlink" title="spring(数据库)事务隔离级别分为四种(级别递减)"></a>spring(数据库)事务隔离级别分为四种(级别递减)</h2><ol>
<li><p><code>Serializable</code>(串行化): 最严格的级别,事务串行执行,资源消耗最大</p>
</li>
<li><p><code>REPEATABLE READ</code>(重复读): 保证了一个事务不会修改已经由另一个事务读取但未提交(回滚)的数据。避免了“脏读取”和“不可重复读取”的情况,但不能避免“幻读”,但是带来了更多的性能损失。</p>
</li>
<li><p><code>READ COMMITTED</code>(提交读): 大多数主流数据库的默认事务等级,保证了一个事务不会读到另一个并行事务已修改但未提交的数据,避免了“脏读取”,但不能避免“幻读”和“不可重复读取”。该级别适用于大多数系统。</p>
</li>
<li><p><code>Read Uncommitted</code>(未提交读): 事务中的修改,即使没有提交,其他事务也可以看得到,会导致“脏读”、“幻读”和“不可重复读取”。</p>
</li>
</ol>
<h2 id="脏读-不可重复读-幻读"><a href="#脏读-不可重复读-幻读" class="headerlink" title="脏读,不可重复读,幻读"></a>脏读,不可重复读,幻读</h2><h3 id="1-脏读-读取了其他事务未提交的数据"><a href="#1-脏读-读取了其他事务未提交的数据" class="headerlink" title="1. 脏读: 读取了其他事务未提交的数据"></a>1. 脏读: 读取了其他事务未提交的数据</h3><table>
<thead>
<tr>
<th></th>
<th>转账事务A</th>
<th>取款事务B</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td></td>
<td>开始事务</td>
</tr>
<tr>
<td>2</td>
<td>开始事务</td>
<td></td>
</tr>
<tr>
<td>3</td>
<td></td>
<td>查询账户余额为2000元</td>
</tr>
<tr>
<td>4</td>
<td></td>
<td>取款1000元,余额被更改为1000元</td>
</tr>
<tr>
<td>5</td>
<td>查询账户余额为1000元(产生脏读)</td>
<td></td>
</tr>
<tr>
<td>6</td>
<td></td>
<td>取款操作发生未知错误,事务回滚,余额变更为2000元</td>
</tr>
<tr>
<td>7</td>
<td>转入2000元,余额被更改为3000元(脏读1000+2000)</td>
<td></td>
</tr>
<tr>
<td>8</td>
<td>提交事务</td>
<td></td>
</tr>
</tbody></table>
<p>事务B取出金额1000元后事务未提交,事务A查到了余额1000元(事务B取出后的金额),当事务B回滚后, 这时事务A累加金额+2000元, 正确应该为4000元,但并不知道事务B已经把金额回滚到2000元, 事务A最后累加的总金额为1000+2000=3000元.</p>
<ul>
<li>正确应该是账户余额为4000元</li>
</ul>
<h3 id="2-不可重复读-前后多次读取-数据内容不一致"><a href="#2-不可重复读-前后多次读取-数据内容不一致" class="headerlink" title="2. 不可重复读: 前后多次读取, 数据内容不一致"></a>2. 不可重复读: 前后多次读取, 数据内容不一致</h3><table>
<thead>
<tr>
<th></th>
<th>转账事务A</th>
<th>取款事务B</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td></td>
<td>开始事务</td>
</tr>
<tr>
<td>2</td>
<td></td>
<td>第一次查询账户余额为2000元</td>
</tr>
<tr>
<td>3</td>
<td>开始事务</td>
<td>其他操作</td>
</tr>
<tr>
<td>4</td>
<td>取款金额1000元, 余额1000元</td>
<td>其他操作</td>
</tr>
<tr>
<td>5</td>
<td>提交事务</td>
<td>其他操作</td>
</tr>
<tr>
<td>6</td>
<td></td>
<td>第二次查询账户余额为1000元</td>
</tr>
</tbody></table>
<p>事务B的事务比较长, 且查询了两次账户, 第一次和第二次取出的金额不匹配, 因此数据不重复了, 系统不可以读取到重复的数据, 成为不可重复读.</p>
<ul>
<li>正确应该是事务B两次查询的金额是一致的</li>
</ul>
<h3 id="3-幻读-前后多次读取-数据总量不一致"><a href="#3-幻读-前后多次读取-数据总量不一致" class="headerlink" title="3. 幻读: 前后多次读取, 数据总量不一致"></a>3. 幻读: 前后多次读取, 数据总量不一致</h3><table>
<thead>
<tr>
<th></th>
<th>出入账事务A</th>
<th>流水事务B</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td></td>
<td>开始事务</td>
</tr>
<tr>
<td>2</td>
<td></td>
<td>第一次查询总流水记录100条</td>
</tr>
<tr>
<td>3</td>
<td>开始事务</td>
<td>第一次查询总流水记录100条</td>
</tr>
<tr>
<td>4</td>
<td>进账出账流水记录+2条</td>
<td>其他操作</td>
</tr>
<tr>
<td>5</td>
<td>提交事务</td>
<td>其他操作</td>
</tr>
<tr>
<td>6</td>
<td></td>
<td>第二次查询总流水记录102条</td>
</tr>
</tbody></table>
<p>事务B在执行读取操作,需要两次统计数据的总量,前一次查询数据总量后,此时事务B执行了新增数据的操作并提交后,这个时候事务A读取的数据总量和之前统计的不一样,就像产生了幻觉一样,平白无故的多了几条数据,成为幻读</p>
<ul>
<li>正确应该是第二次查询也是100条记录和第一次一致</li>
</ul>
<h3 id="不可重复读和幻读的区别"><a href="#不可重复读和幻读的区别" class="headerlink" title="不可重复读和幻读的区别"></a>不可重复读和幻读的区别</h3><ol>
<li><p>不可重复读是读取了其他事务更改的数据,针对insert与update操作</p>
<p> 解决方法:</p>
<ul>
<li>用行级锁,锁定该行,事务A多次读取操作完成后才释放该锁,这个时候才允许其他事务更改刚才的数据.</li>
</ul>
</li>
<li><p>幻读是读取了其他事务新增的数据,针对insert与delete操作</p>
<p> 解决方法:</p>
<ul>
<li>使用表级锁,锁定整张表,事务A多次读取数据总量之后才释放该锁,这个时候才允许其他事务新增数据.</li>
<li>幻读的另一种解决方案,版本控制,表级锁用了那和串行读没什么区别,性能太低,在mysql中innodb自带有版本控制,可以很好的解决,而且幻读产生的根本原因是采用的行级锁,所以只针对脏读和重复读有用</li>
</ul>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/05/2019-05-05-git%20flow/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/my-avatar.gif">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="f0.95">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/05/2019-05-05-git%20flow/" class="post-title-link" itemprop="url">Git Flow</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-05-05 15:38:23" itemprop="dateCreated datePublished" datetime="2019-05-05T15:38:23+08:00">2019-05-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-01-19 14:39:31" itemprop="dateModified" datetime="2020-01-19T14:39:31+08:00">2020-01-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/git/" itemprop="url" rel="index"><span itemprop="name">git</span></a>
                </span>
            </span>

          
            <span id="/2019/05/05/2019-05-05-git%20flow/" class="post-meta-item leancloud_visitors" data-flag-title="Git Flow" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2019/05/05/2019-05-05-git%20flow/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/05/05/2019-05-05-git%20flow/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Git-Flow"><a href="#Git-Flow" class="headerlink" title="Git Flow"></a>Git Flow</h1><h2 id="分支图"><a href="#分支图" class="headerlink" title="分支图"></a>分支图</h2><p><img src="/assets%5Cimages%5Cblog-images%5Cgit-workflow-release-cycle-4maintenance.png" alt="Image text"></p>
<h2 id="分支说明"><a href="#分支说明" class="headerlink" title="分支说明"></a>分支说明</h2><table>
<thead>
<tr>
<th>分支名</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>Master</td>
<td>上线/线上分支</td>
</tr>
<tr>
<td>Hotfix</td>
<td>修复线上补丁分支</td>
</tr>
<tr>
<td>Release</td>
<td>发布分支(待上线,上线版本测试专用)</td>
</tr>
<tr>
<td>Develop</td>
<td>开发分支(只能提交准备上线版本的功能)</td>
</tr>
<tr>
<td>Feature</td>
<td>功能分支(每个人的独立分支, 只有完成且在当前准备上线版本时才能合并到Develop)</td>
</tr>
</tbody></table>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/05/2019-05-05-git%E6%8F%90%E4%BA%A4%E6%97%A5%E5%BF%97%E6%A0%BC%E5%BC%8F%E8%A7%84%E8%8C%83/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/my-avatar.gif">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="f0.95">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/05/05/2019-05-05-git%E6%8F%90%E4%BA%A4%E6%97%A5%E5%BF%97%E6%A0%BC%E5%BC%8F%E8%A7%84%E8%8C%83/" class="post-title-link" itemprop="url">Git commit message 提交日志格式</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-05-05 11:34:07" itemprop="dateCreated datePublished" datetime="2019-05-05T11:34:07+08:00">2019-05-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-01-19 14:39:27" itemprop="dateModified" datetime="2020-01-19T14:39:27+08:00">2020-01-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/git/" itemprop="url" rel="index"><span itemprop="name">git</span></a>
                </span>
            </span>

          
            <span id="/2019/05/05/2019-05-05-git%E6%8F%90%E4%BA%A4%E6%97%A5%E5%BF%97%E6%A0%BC%E5%BC%8F%E8%A7%84%E8%8C%83/" class="post-meta-item leancloud_visitors" data-flag-title="Git commit message 提交日志格式" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2019/05/05/2019-05-05-git%E6%8F%90%E4%BA%A4%E6%97%A5%E5%BF%97%E6%A0%BC%E5%BC%8F%E8%A7%84%E8%8C%83/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/05/05/2019-05-05-git%E6%8F%90%E4%BA%A4%E6%97%A5%E5%BF%97%E6%A0%BC%E5%BC%8F%E8%A7%84%E8%8C%83/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Git-commit-message-提交日志格式"><a href="#Git-commit-message-提交日志格式" class="headerlink" title="Git commit message 提交日志格式"></a>Git commit message 提交日志格式</h1><h2 id="1-提交日志格式"><a href="#1-提交日志格式" class="headerlink" title="1. 提交日志格式"></a>1. 提交日志格式</h2><p>每次提交, Commit message 都包括三个部分: <code>header</code>, <code>body</code>, <code>footer</code>。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>(<span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>): <span class="hljs-tag">&lt;<span class="hljs-name">subject</span>&gt;</span><br>// 空行<br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>// 空行<br><span class="hljs-tag">&lt;<span class="hljs-name">footer</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>其中<code>header</code>是必须的, <code>body</code>和<code>footer</code>可以省略。</p>
<p>提交消息的任何行都不能超过100个字符！为了在github以及各种git工具中更容易阅读消息。</p>
<h2 id="2-header"><a href="#2-header" class="headerlink" title="2. header"></a>2. header</h2><p>header部分只有一行, 包括三个字段<code>type</code>(必须), <code>scope</code>, <code>subject</code>。</p>
<h3 id="1-type"><a href="#1-type" class="headerlink" title="(1) type"></a>(1) type</h3><p>用于说明<code>commit</code>的类别。</p>
<table>
<thead>
<tr>
<th>type</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>feat</td>
<td>新功能(feature)</td>
</tr>
<tr>
<td>fix</td>
<td>修补bug</td>
</tr>
<tr>
<td>docs</td>
<td>文档(documentation)</td>
</tr>
<tr>
<td>perf</td>
<td>改进性能的代码更改</td>
</tr>
<tr>
<td>style</td>
<td>不影响代码含义的更改(空格，格式，缺少分号等)</td>
</tr>
<tr>
<td>refactor</td>
<td>重构(即不是新增功能, 也不是修改bug的代码变动)</td>
</tr>
<tr>
<td>test</td>
<td>添加缺失测试或更正现有测试</td>
</tr>
<tr>
<td>chore</td>
<td>其他修改(非src或测试文件的修改)</td>
</tr>
<tr>
<td>ci</td>
<td>CI配置文件和脚本的更改(示例范围: Circle, BrowserStack, SauceLabs)</td>
</tr>
<tr>
<td>build</td>
<td>影响构建系统或外部依赖项的更改(示例范围：gulp，broccoli，npm)</td>
</tr>
<tr>
<td>revert</td>
<td>返回以前的提交</td>
</tr>
</tbody></table>
<h3 id="2-scope"><a href="#2-scope" class="headerlink" title="(2) scope"></a>(2) scope</h3><p>用于说明<code>commit</code>影响的范围, 比如数据层、控制层、视图层等等, 视项目不同而不同。</p>
<h3 id="3-scope"><a href="#3-scope" class="headerlink" title="(3) scope"></a>(3) scope</h3><p>是<code>commit</code>目的的简短描述, 不超过50个字符。</p>
<ul>
<li>以动词开头, 使用第一人称现在时, 比如change, 而不是changed或changes</li>
<li>第一个字母小写</li>
<li>结尾不加句号(.)</li>
</ul>
<h2 id="3-body"><a href="#3-body" class="headerlink" title="3. body"></a>3. body</h2><p><code>body</code>部分是对本次<code>commit</code>的详细描述, 可以分成多行。</p>
<p>下面是一个范例:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs text">More detailed explanatory text, if necessary.  Wrap it to about 72 characters or so. <br><br>Further paragraphs come after blank lines.<br><br>- Bullet points are okay, too<br>- Use a hanging indent<br></code></pre></td></tr></table></figure>

<p>有两个注意点:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs text">(1)使用第一人称现在时, 比如使用change而不是changed或changes。<br><br>(2)应该说明代码变动的动机, 以及与以前行为的对比。<br></code></pre></td></tr></table></figure>

<h2 id="4-footer"><a href="#4-footer" class="headerlink" title="4. footer"></a>4. footer</h2><p><code>footer</code>部分只用于两种情况:</p>
<h3 id="1-不兼容变动"><a href="#1-不兼容变动" class="headerlink" title="(1)不兼容变动"></a>(1)不兼容变动</h3><p>如果当前代码与上一个版本不兼容，则<code>footer</code>部分以<code>BREAKING CHANGE</code>开头，后面是对变动的描述、以及变动理由和迁移方法。</p>
<h3 id="2-关闭Issue"><a href="#2-关闭Issue" class="headerlink" title="(2)关闭Issue"></a>(2)关闭Issue</h3><p>如果当前<code>commit</code>针对某个issue，那么可以在 Footer 部分关闭这个 issue 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">Closes #234<br></code></pre></td></tr></table></figure>

<p>也可以一次关闭多个 issue 。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">Closes #123, #245, #992<br></code></pre></td></tr></table></figure>

<h2 id="5-revert"><a href="#5-revert" class="headerlink" title="5. revert"></a>5. revert</h2><p>还有一种特殊情况，如果当前<code>commit</code>用于撤销以前的 commit，则必须以revert:开头，后面跟着被撤销<code>commit</code>的 Header。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs text">revert: feat(pencil): add &#39;graphiteWidth&#39; option<br><br>This reverts commit 667ecc1654a317a13331b17617d973392f415f02.<br></code></pre></td></tr></table></figure>

<p>Body部分的格式是固定的，必须写成This reverts commit <hash>.，其中的hash是被撤销<code>commit</code>的 SHA 标识符。</p>
<p>如果当前<code>commit</code>与被撤销的 commit，在同一个发布(release)里面，那么它们都不会出现在 Change log 里面。如果两者在不同的发布，那么当前 commit，会出现在 Change log 的Reverts小标题下面。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/12/2019-03-12-%E9%9D%A2%E8%AF%95%E9%A2%98BitSet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/my-avatar.gif">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="f0.95">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/03/12/2019-03-12-%E9%9D%A2%E8%AF%95%E9%A2%98BitSet/" class="post-title-link" itemprop="url">面试题-BitSet</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-03-12 16:00:46" itemprop="dateCreated datePublished" datetime="2019-03-12T16:00:46+08:00">2019-03-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-01-19 14:39:53" itemprop="dateModified" datetime="2020-01-19T14:39:53+08:00">2020-01-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%9D%A2%E8%AF%95%E9%A2%98/" itemprop="url" rel="index"><span itemprop="name">面试题</span></a>
                </span>
            </span>

          
            <span id="/2019/03/12/2019-03-12-%E9%9D%A2%E8%AF%95%E9%A2%98BitSet/" class="post-meta-item leancloud_visitors" data-flag-title="面试题-BitSet" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2019/03/12/2019-03-12-%E9%9D%A2%E8%AF%95%E9%A2%98BitSet/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/03/12/2019-03-12-%E9%9D%A2%E8%AF%95%E9%A2%98BitSet/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="题目-有1千万个随机数，随机数的范围在1到1亿之间。现在要求写出一种算法，将1到1亿之间没有在随机数中的数求出来"><a href="#题目-有1千万个随机数，随机数的范围在1到1亿之间。现在要求写出一种算法，将1到1亿之间没有在随机数中的数求出来" class="headerlink" title="题目: 有1千万个随机数，随机数的范围在1到1亿之间。现在要求写出一种算法，将1到1亿之间没有在随机数中的数求出来"></a>题目: 有1千万个随机数，随机数的范围在1到1亿之间。现在要求写出一种算法，将1到1亿之间没有在随机数中的数求出来</h2><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Alibaba</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;<br><br>        <span class="hljs-comment">// 生成随机数</span><br>        Random random=<span class="hljs-keyword">new</span> Random();<br>        List&lt;Integer&gt; list=<span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">10000000</span>;i++) &#123;<br>            <span class="hljs-keyword">int</span> randomResult=random.nextInt(<span class="hljs-number">100000000</span>);<br>            list.add(randomResult);<br>        &#125;<br><br>        <span class="hljs-comment">// 打印生成随机数</span><br>        System.out.println(<span class="hljs-string">"产生的随机数有"</span>);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;list.size();i++) &#123;<br>            System.out.println(list.get(i));<br>        &#125;<br><br>        <span class="hljs-comment">// 创建一亿位的BitSet</span><br>        BitSet bitSet=<span class="hljs-keyword">new</span> BitSet(<span class="hljs-number">100000000</span>);<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">10000000</span>;i++) &#123;<br>            <span class="hljs-comment">// 把随机数放进去</span><br>            bitSet.set(list.get(i));<br>        &#125;<br><br>        <span class="hljs-comment">// 打印结果:0~1亿不在上述随机数中的结果</span><br>        System.out.println(<span class="hljs-string">"0~1亿不在上述随机数中有"</span> + bitSet.size());<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100000000</span>; i++) &#123;<br>            <span class="hljs-keyword">if</span>(!bitSet.get(i)) &#123;<br>                System.out.println(i);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="说明-BitSet"><a href="#说明-BitSet" class="headerlink" title="说明 BitSet"></a>说明 BitSet</h2><ol>
<li>去重</li>
<li>正序</li>
<li>长度为64倍数(默认64)</li>
<li>get()方法是返回boolean值, 存在值为true, 不存在为false(注意:这个get的参数是值, 并不是索引下标)</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/12/2019-03-12-springmvc%E8%BF%94%E5%9B%9E%E5%9B%BE%E7%89%87/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/my-avatar.gif">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="f0.95">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2019/03/12/2019-03-12-springmvc%E8%BF%94%E5%9B%9E%E5%9B%BE%E7%89%87/" class="post-title-link" itemprop="url">spring mvc 返回图片</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-03-12 11:16:00" itemprop="dateCreated datePublished" datetime="2019-03-12T11:16:00+08:00">2019-03-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-01-19 14:39:36" itemprop="dateModified" datetime="2020-01-19T14:39:36+08:00">2020-01-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%B0%E5%BD%95/" itemprop="url" rel="index"><span itemprop="name">记录</span></a>
                </span>
            </span>

          
            <span id="/2019/03/12/2019-03-12-springmvc%E8%BF%94%E5%9B%9E%E5%9B%BE%E7%89%87/" class="post-meta-item leancloud_visitors" data-flag-title="spring mvc 返回图片" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2019/03/12/2019-03-12-springmvc%E8%BF%94%E5%9B%9E%E5%9B%BE%E7%89%87/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2019/03/12/2019-03-12-springmvc%E8%BF%94%E5%9B%9E%E5%9B%BE%E7%89%87/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="spring-mvc-返回图片"><a href="#spring-mvc-返回图片" class="headerlink" title="spring mvc 返回图片"></a>spring mvc 返回图片</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@RestController</span><br><br>...<br><br>    <span class="hljs-meta">@PostMapping</span>(<span class="hljs-string">"wxa/code"</span>)<br>    <span class="hljs-keyword">public</span> ResponseEntity&lt;?&gt; getWxaShareCode() &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br><br>            ByteArrayOutputStream byteArrayOutputStream =<br>                    TucHttpUtil.httpPostInputStream(<span class="hljs-string">"https://developers.weixin.qq.com/miniprogram/dev/image/qrcode/qrcode.png?t=18082721"</span>, <span class="hljs-keyword">null</span>);<br><br>            InputStream is = <span class="hljs-keyword">new</span> ByteArrayInputStream(byteArrayOutputStream.toByteArray());<br>            <span class="hljs-keyword">return</span> ResponseEntity.ok()<br>                    .header(<span class="hljs-string">"content-type"</span>,<span class="hljs-string">"image/png"</span>)<br>                    .body(<span class="hljs-keyword">new</span> InputStreamResource(is));<br><br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            <span class="hljs-keyword">return</span> ResponseEntity.notFound().build();<br>        &#125;<br>    &#125;<br>...<br></code></pre></td></tr></table></figure>

<ol>
<li>使用ResponseEntity可以和@RestController共用</li>
<li>ResponseEntity是restful的响应体, 相当于sevlet的HttpSevletResponse的设置</li>
<li>InputSteam如果直接返回可能会导致流无法关闭, 使用ByteArrayOutputStream把数据保存在内存, 然后返回(可能会涉及回收问题)</li>
<li>返回文件(比如图片), 需要设置header(“content-type”,”image/png”)</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/20/2018-06-20-mybatis-generator/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/my-avatar.gif">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="f0.95">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/06/20/2018-06-20-mybatis-generator/" class="post-title-link" itemprop="url">mybaits-generator生成器</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-06-20 11:48:00" itemprop="dateCreated datePublished" datetime="2018-06-20T11:48:00+08:00">2018-06-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-01-19 14:39:44" itemprop="dateModified" datetime="2020-01-19T14:39:44+08:00">2020-01-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%B7%A5%E5%85%B7/" itemprop="url" rel="index"><span itemprop="name">工具</span></a>
                </span>
            </span>

          
            <span id="/2018/06/20/2018-06-20-mybatis-generator/" class="post-meta-item leancloud_visitors" data-flag-title="mybaits-generator生成器" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2018/06/20/2018-06-20-mybatis-generator/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2018/06/20/2018-06-20-mybatis-generator/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h1><p>使用java类+yml配置+JUnit搭建mybatis生成器项目, 能让其他项目快速接入生成mybatis使用的类和文件。</p>
<ol>
<li>java类用于代替传统的xml配置, 简化配置成本和上手成本。</li>
<li>配置文件使用YAML语法, 相比xml能大大增强阅读性。</li>
<li>使用JUnit启动运行, 能有效隔离项目, 区分业务和工具, 降低对项目的影响。</li>
</ol>
<h1 id="需要引入的jar包和版本说明"><a href="#需要引入的jar包和版本说明" class="headerlink" title="需要引入的jar包和版本说明"></a>需要引入的jar包和版本说明</h1><table>
<thead>
<tr>
<th>jar包</th>
<th>版本</th>
<th>作用</th>
<th>是否必要</th>
</tr>
</thead>
<tbody><tr>
<td>lombok</td>
<td>1.16.20</td>
<td>自动生成getter/setter方法, 加强源码阅读性</td>
<td>可选</td>
</tr>
<tr>
<td>fastjson</td>
<td>1.2.47</td>
<td>JSON序列化框架</td>
<td>必要, 也可以用其他序列化框架代替</td>
</tr>
<tr>
<td>snakeyaml</td>
<td>1.17</td>
<td>用于读取解析YAML文件配置</td>
<td>必要</td>
</tr>
<tr>
<td>mysql-connector-java</td>
<td>5.1.46</td>
<td>用于连接数据库</td>
<td>必要</td>
</tr>
<tr>
<td>⭐mybatis-generator-core</td>
<td>1.3.6</td>
<td>生成器的核心包, 建议升级到1.3.6以上版本,这个版本支持覆盖文件</td>
<td>必要</td>
</tr>
<tr>
<td>⭐mybatis-generator-maven-plugin</td>
<td>1.3.6</td>
<td>生成器maven插件(内包含了生成器核心包)</td>
<td>必要</td>
</tr>
<tr>
<td>junit</td>
<td>4.12</td>
<td>单例测试, 用于启动</td>
<td>必要</td>
</tr>
</tbody></table>
<h1 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h1><h2 id="生成文件"><a href="#生成文件" class="headerlink" title="生成文件"></a>生成文件</h2><ol>
<li>entity.java</li>
<li>mapper.java</li>
<li>mapper.xml</li>
</ol>
<h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs text"><br>生成文件目录<br>src<br>    main<br>        java<br>            entity          -------- 生成的实体<br>            mapper          -------- 生成的mapper<br>            po              -------- 自定义po(用于自定义sql映射的实体)<br>            mapperExt       -------- 自定义mapper<br>        resources<br>            mapperXml       -------- 自动生成sql<br>            mapperXmlExt    -------- 自定义sql<br><br>运行目录<br>    test<br>        java<br>            generator   -------- 存放生成器的启动类(单例测试)<br>        resource    --------- 存放生成器YMAL配置文件&#96;generator.yml&#96;<br></code></pre></td></tr></table></figure>

<h1 id="配置和类"><a href="#配置和类" class="headerlink" title="配置和类"></a>配置和类</h1><h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><ol>
<li><p>新建<code>generator.yml</code></p>
 <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">#需要生成的表名</span><br><span class="hljs-attr">tableNames :</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">user_table</span><br><br><span class="hljs-comment">#------------------------- 数据库连接 ----------------------------------</span><br><br><span class="hljs-attr">url :</span> <span class="hljs-string">jdbc:mysql://host:port/dbname</span><br><span class="hljs-attr">user :</span> <span class="hljs-string">username</span><br><span class="hljs-attr">password :</span> <span class="hljs-string">password</span><br><br><span class="hljs-comment">#------------------------- 个人路径(改这里就可以) ----------------------------------</span><br><br><span class="hljs-comment">#项目所在的地址路径(默认根据target/自动获取所在根目录, 目录下mybatis-generator文件夹, 也可自定义设置绝对路径)</span><br><span class="hljs-comment">#projectPath : D:\Project\</span><br><span class="hljs-comment">#jar包的绝对路径(默认根据driverClass包名自动获取, 也可自定义设置绝对路径)</span><br><span class="hljs-comment">#classPath : D:\mysql\mysql-connector-java-5.1.40.jar</span><br><br><span class="hljs-comment"># ------------------------- 项目配置 ----------------------------------</span><br><br><span class="hljs-attr">driverClass :</span> <span class="hljs-string">com.mysql.jdbc.Driver</span><br><br><span class="hljs-comment">#实体包名和位置</span><br><span class="hljs-attr">javaModelGeneratorPackage :</span> <span class="hljs-string">com.user.entity</span><br><span class="hljs-attr">javaModelGeneratorProject :</span> <span class="hljs-string">src\main\java</span><br><br><span class="hljs-comment">#mapper包名和位置</span><br><span class="hljs-attr">javaClientGeneratorPackage :</span> <span class="hljs-string">com.user.mapper</span><br><span class="hljs-attr">javaClientGeneratorProject :</span> <span class="hljs-string">src\main\java</span><br><br><span class="hljs-comment">#mapperXml位置</span><br><span class="hljs-attr">sqlMapGeneratorPackage :</span> <span class="hljs-string">mapperXml</span><br><span class="hljs-attr">sqlMapGeneratorProject :</span> <span class="hljs-string">src\main\resources</span><br></code></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="java类"><a href="#java类" class="headerlink" title="java类"></a>java类</h2><ol>
<li><p>配置覆盖参数</p>
<p> 生成规则默认使用IntrospectedTableMyBatis3Impl, 但是没有isMergeable(覆盖)的可设置方法, 改一下<br> 注意:1.3.6之前的版本都不能设置覆盖, 只能追加(可能我不会), 1.3.6版本开放了这个参数</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyIntrospectedTableMyBatis3Impl</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">IntrospectedTableMyBatis3Impl</span> </span>&#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;GeneratedXmlFile&gt; <span class="hljs-title">getGeneratedXmlFiles</span><span class="hljs-params">()</span> </span>&#123;<br>        List&lt;GeneratedXmlFile&gt; answer = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br><br>        <span class="hljs-keyword">if</span> (xmlMapperGenerator != <span class="hljs-keyword">null</span>) &#123;<br>            Document document = xmlMapperGenerator.getDocument();<br>            GeneratedXmlFile gxf = <span class="hljs-keyword">new</span> GeneratedXmlFile(document,<br>                    getMyBatis3XmlMapperFileName(), getMyBatis3XmlMapperPackage(),<br>                    context.getSqlMapGeneratorConfiguration().getTargetProject(),<br>                    <span class="hljs-keyword">false</span>, context.getXmlFormatter());<br>            <span class="hljs-keyword">if</span> (context.getPlugins().sqlMapGenerated(gxf, <span class="hljs-keyword">this</span>)) &#123;<br>                answer.add(gxf);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> answer;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>配置信息,主要获取yml配置文件</p>
 <figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs java">@Data<br>@Accessors(chain = true)<br>public class MyGeneratorConfig &#123;<br><br>    private  String[] tableNames;<br>    private  String classPath;<br>    private  String driverClass;<br>    private  String url;<br>    private  String user;<br>    private  String password;<br>    private  String schema;<br>    /**<br>    * 绝对路径项目根目录<br>    */<br>    private  String projectPath;<br>    private  String javaModelGeneratorPackage;<br>    private  String javaModelGeneratorProject;<br>    private  String javaClientGeneratorPackage;<br>    private  String javaClientGeneratorProject;<br>    private  String sqlMapGeneratorPackage;<br>    private  String sqlMapGeneratorProject;<br><br>    MyGeneratorConfig() &#123;<br><br>    &#125;<br><br>    /**<br>    * 配置文件"generator.yml"<br>    * @param ymlName<br>    * @return<br>    */<br>    public MyGeneratorConfig getConfig(String ymlName) &#123;<br><br>        Map&lt;String, Object&gt; map = new HashMap&lt;&gt;();<br>        Yaml yaml = new Yaml();<br>        InputStream is = this.getClass().getClassLoader().getResourceAsStream(ymlName);<br>        if (is != null) &#123;<br>            Object obj = yaml.load(is);<br>            if (obj != null) &#123;<br>                map = (Map&lt;String, Object&gt;) obj;<br>            &#125;<br>        &#125;<br><br>        MyGeneratorConfig myGeneratorConfig = JSON.parseObject(JSON.toJSONString(map), this.getClass());<br><br>        if (StringUtils.isBlank(myGeneratorConfig.getClassPath())) &#123;<br>            // 获取驱动包路径<br>            try &#123;<br>                String driverClassPath = Class.forName(myGeneratorConfig.getDriverClass())<br>                        .getProtectionDomain()<br>                        .getCodeSource()<br>                        .getLocation()<br>                        .getPath()<br>                        .replace("/", "\\").substring(1);<br>                myGeneratorConfig.setClassPath(driverClassPath);<br>            &#125; catch (ClassNotFoundException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br><br>        if (StringUtils.isBlank(myGeneratorConfig.getProjectPath())) &#123;<br>            // 默认获取项目路径<br>            String[] projectPaths = MyGeneratorConfig.class.getResource("/").getPath().split("/target");<br>            projectPath = projectPaths[0].replace("/", "\\").substring(1) + "\\" + "mybatis-generator" + "\\";<br>            // 处理中文路劲<br>            try &#123;<br>                projectPath = java.net.URLDecoder.decode(projectPath,"utf-8");<br>            &#125; catch (UnsupportedEncodingException e) &#123;<br>                e.printStackTrace();<br>            &#125;<br>            myGeneratorConfig.setProjectPath(projectPath);<br>        &#125;<br><br>        projectPath = myGeneratorConfig.getProjectPath();<br>        myGeneratorConfig.setJavaModelGeneratorProject(projectPath + myGeneratorConfig.getJavaModelGeneratorProject());<br>        myGeneratorConfig.setJavaClientGeneratorProject(projectPath + myGeneratorConfig.getJavaClientGeneratorProject());<br>        myGeneratorConfig.setSqlMapGeneratorProject(projectPath + myGeneratorConfig.getSqlMapGeneratorProject());<br><br>        // 创建文件夹<br>        new File(myGeneratorConfig.getProjectPath()).mkdirs();<br>        new File(myGeneratorConfig.getJavaModelGeneratorProject()).mkdirs();<br>        new File(myGeneratorConfig.getJavaClientGeneratorProject()).mkdirs();<br>        new File(myGeneratorConfig.getSqlMapGeneratorProject()).mkdirs();<br><br>        System.out.println("entity path:" + myGeneratorConfig.getJavaModelGeneratorProject());<br>        System.out.println("mapperJava path:" + myGeneratorConfig.getJavaClientGeneratorProject());<br>        System.out.println("mapperXml path:" + myGeneratorConfig.getSqlMapGeneratorProject());<br><br>        return myGeneratorConfig;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>构建生成配置</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MybatisGeneratorMain</span> </span>&#123;<br><br>    <span class="hljs-keyword">private</span> Log logger = LogFactory.getLog(getClass());<br><br>    <span class="hljs-keyword">private</span> Context context = <span class="hljs-keyword">new</span> Context(ModelType.FLAT);<br>    <span class="hljs-keyword">private</span> List&lt;String&gt; warnings = <span class="hljs-keyword">new</span> ArrayList&lt;&gt;();<br>    <span class="hljs-comment">/**<br>    * 获取配置<br>    */</span><br>    <span class="hljs-keyword">private</span> MyGeneratorConfig myGeneratorConfig = <span class="hljs-keyword">null</span>;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MybatisGeneratorMain</span><span class="hljs-params">(String ymlPath)</span> </span>&#123;<br><br>        <span class="hljs-comment">// 设置配置文件</span><br>        <span class="hljs-keyword">this</span>.myGeneratorConfig = <span class="hljs-keyword">new</span> MyGeneratorConfig().getConfig(ymlPath);<br>        <span class="hljs-comment">// 生成</span><br>        generator();<br>    &#125;<br><br>    <span class="hljs-comment">/**<br>    * 生成代码主方法<br>    */</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">generator</span><span class="hljs-params">()</span> </span>&#123;<br><br>        <span class="hljs-keyword">if</span> (StringUtils.isNotBlank(myGeneratorConfig.getSchema())) &#123;<br>            myGeneratorConfig.setUrl(myGeneratorConfig.getUrl() + <span class="hljs-string">"/"</span> + myGeneratorConfig.getSchema());<br>        &#125;<br><br>        context.setId(<span class="hljs-string">"prod"</span>);<br><span class="hljs-comment">//        context.setTargetRuntime("MyBatis3");</span><br>        context.setTargetRuntime(MyIntrospectedTableMyBatis3Impl<span class="hljs-class">.<span class="hljs-keyword">class</span>.<span class="hljs-title">getName</span>())</span>;<br><br>        <span class="hljs-comment">// ---------- 配置信息 start ----------</span><br><br>        pluginBuilder(context, <span class="hljs-string">"org.mybatis.generator.plugins.ToStringPlugin"</span>);<br>        pluginBuilder(context, <span class="hljs-string">"org.mybatis.generator.plugins.FluentBuilderMethodsPlugin"</span>);<br><br>        commentGeneratorBuilder(context);<br><br>        jdbcConnectionBuilder(context);<br><br>        javaTypeResolverBuilder(context);<br><br>        javaModelGeneratorBuilder(context);<br><br>        sqlMapGeneratorBuilder(context);<br><br>        javaClientGeneratorBuilder(context);<br><br>        tableBuilder(context, myGeneratorConfig.getSchema(), myGeneratorConfig.getTableNames());<br><br>        <span class="hljs-comment">// ---------- 配置信息 end ----------</span><br><br><br>        <span class="hljs-comment">// --------- 校验,执行 ---------</span><br>        Configuration config = <span class="hljs-keyword">new</span> Configuration();<br>        config.addClasspathEntry(myGeneratorConfig.getClassPath());<br>        config.addContext(context);<br>        DefaultShellCallback callback = <span class="hljs-keyword">new</span> DefaultShellCallback(<span class="hljs-keyword">true</span>);<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            MyBatisGenerator myBatisGenerator = <span class="hljs-keyword">new</span> MyBatisGenerator(config, callback, warnings);<br>            myBatisGenerator.generate(<span class="hljs-keyword">null</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>        logger.warn(<span class="hljs-string">"warnings="</span> + warnings);<br>    &#125;<br><br>    <span class="hljs-comment">/**<br>    * plugin<br>    * <span class="hljs-doctag">@param</span> context<br>    */</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pluginBuilder</span><span class="hljs-params">(Context context, String configurationType)</span> </span>&#123;<br>        PluginConfiguration pluginConfiguration = <span class="hljs-keyword">new</span> PluginConfiguration();<br>        pluginConfiguration.setConfigurationType(configurationType);<br>        context.addPluginConfiguration(pluginConfiguration);<br>    &#125;<br><br>    <span class="hljs-comment">/**<br>    * commentGenerator<br>    * <span class="hljs-doctag">@param</span> context<br>    */</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">commentGeneratorBuilder</span><span class="hljs-params">(Context context)</span> </span>&#123;<br>        CommentGeneratorConfiguration commentGeneratorConfiguration = <span class="hljs-keyword">new</span> CommentGeneratorConfiguration();<br>        commentGeneratorConfiguration.addProperty(<span class="hljs-string">"suppressDate"</span>, <span class="hljs-string">"true"</span>);<br>        commentGeneratorConfiguration.addProperty(<span class="hljs-string">"suppressAllComments"</span>, <span class="hljs-string">"false"</span>);<br>        commentGeneratorConfiguration.addProperty(<span class="hljs-string">"addRemarkComments"</span>, <span class="hljs-string">"true"</span>);<br>        commentGeneratorConfiguration.addProperty(<span class="hljs-string">"javaFileEncoding"</span>, <span class="hljs-string">"UTF-8"</span>);<br>        context.setCommentGeneratorConfiguration(commentGeneratorConfiguration);<br>    &#125;<br><br>    <span class="hljs-comment">/**<br>    * jdbcConnection<br>    * <span class="hljs-doctag">@param</span> context<br>    */</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">jdbcConnectionBuilder</span><span class="hljs-params">(Context context)</span> </span>&#123;<br>        JDBCConnectionConfiguration jdbc = <span class="hljs-keyword">new</span> JDBCConnectionConfiguration();<br>        jdbc.setConnectionURL(myGeneratorConfig.getUrl());<br>        jdbc.setDriverClass(myGeneratorConfig.getDriverClass());<br>        jdbc.setUserId(myGeneratorConfig.getUser());<br>        jdbc.setPassword(myGeneratorConfig.getPassword());<br>        context.setJdbcConnectionConfiguration(jdbc);<br>    &#125;<br><br>    <span class="hljs-comment">/**<br>    * javaTypeResolver<br>    * <span class="hljs-doctag">@param</span> context<br>    */</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">javaTypeResolverBuilder</span><span class="hljs-params">(Context context)</span> </span>&#123;<br>        JavaTypeResolverConfiguration javaTypeResolverConfiguration = <span class="hljs-keyword">new</span> JavaTypeResolverConfiguration();<br>        javaTypeResolverConfiguration.addProperty(<span class="hljs-string">"forceBigDecimals"</span>, <span class="hljs-string">"true"</span>);<br>        context.setJavaTypeResolverConfiguration(javaTypeResolverConfiguration);<br>    &#125;<br><br>    <span class="hljs-comment">/**<br>    * javaModelGenerator<br>    * <span class="hljs-doctag">@param</span> context<br>    */</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">javaModelGeneratorBuilder</span><span class="hljs-params">(Context context)</span> </span>&#123;<br>        JavaModelGeneratorConfiguration javaModel = <span class="hljs-keyword">new</span> JavaModelGeneratorConfiguration();<br>        javaModel.setTargetPackage(myGeneratorConfig.getJavaModelGeneratorPackage());<br>        javaModel.setTargetProject(myGeneratorConfig.getJavaModelGeneratorProject());<br>        javaModel.addProperty(<span class="hljs-string">"trimStrings"</span>, <span class="hljs-string">"true"</span>);<br>        javaModel.addProperty(<span class="hljs-string">"enableSubPackages"</span>, <span class="hljs-string">"true"</span>);<br>        context.setJavaModelGeneratorConfiguration(javaModel);<br>    &#125;<br><br>    <span class="hljs-comment">/**<br>    * sqlMapGenerator<br>    * <span class="hljs-doctag">@param</span> context<br>    */</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">sqlMapGeneratorBuilder</span><span class="hljs-params">(Context context)</span> </span>&#123;<br>        SqlMapGeneratorConfiguration sqlMapGeneratorConfiguration = <span class="hljs-keyword">new</span> SqlMapGeneratorConfiguration();<br>        sqlMapGeneratorConfiguration.setTargetPackage(myGeneratorConfig.getSqlMapGeneratorPackage());<br>        sqlMapGeneratorConfiguration.setTargetProject(myGeneratorConfig.getSqlMapGeneratorProject());<br>        sqlMapGeneratorConfiguration.addProperty(<span class="hljs-string">"enableSubPackages"</span>, <span class="hljs-string">"true"</span>);<br>        context.setSqlMapGeneratorConfiguration(sqlMapGeneratorConfiguration);<br>    &#125;<br><br>    <span class="hljs-comment">/**<br>    * javaClientGenerator<br>    * <span class="hljs-doctag">@param</span> context<br>    */</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">javaClientGeneratorBuilder</span><span class="hljs-params">(Context context)</span> </span>&#123;<br>        JavaClientGeneratorConfiguration javaClientGeneratorConfiguration = <span class="hljs-keyword">new</span> JavaClientGeneratorConfiguration();<br>        javaClientGeneratorConfiguration.setTargetPackage(myGeneratorConfig.getJavaClientGeneratorPackage());<br>        javaClientGeneratorConfiguration.setTargetProject(myGeneratorConfig.getJavaClientGeneratorProject());<br>        javaClientGeneratorConfiguration.setConfigurationType(<span class="hljs-string">"XMLMAPPER"</span>);<br>        javaClientGeneratorConfiguration.addProperty(<span class="hljs-string">"enableSubPackages"</span>, <span class="hljs-string">"true"</span>);<br>        context.setJavaClientGeneratorConfiguration(javaClientGeneratorConfiguration);<br><br>    &#125;<br><br>    <span class="hljs-comment">/**<br>    * table<br>    * <span class="hljs-doctag">@param</span> context<br>    * <span class="hljs-doctag">@param</span> schema        添加SQL表名前面的库名<br>    * <span class="hljs-doctag">@param</span> tableName<br>    */</span><br>    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tableBuilder</span><span class="hljs-params">(Context context, String schema, String...tableName)</span> </span>&#123;<br>        <span class="hljs-keyword">for</span> (String table : tableName) &#123;<br>            TableConfiguration tableConfiguration = <span class="hljs-keyword">new</span> TableConfiguration(context);<br>            tableConfiguration.setTableName(table);<br>            tableConfiguration.setCountByExampleStatementEnabled(<span class="hljs-keyword">false</span>);<br>            tableConfiguration.setUpdateByExampleStatementEnabled(<span class="hljs-keyword">false</span>);<br>            tableConfiguration.setDeleteByExampleStatementEnabled(<span class="hljs-keyword">false</span>);<br>            tableConfiguration.setSelectByExampleStatementEnabled(<span class="hljs-keyword">false</span>);<br>            <span class="hljs-keyword">if</span> (StringUtils.isNotBlank(schema)) &#123;<br>                tableConfiguration.setSchema(schema);<br>                tableConfiguration.addProperty(<span class="hljs-string">"runtimeSchema"</span>, schema);<br>            &#125;<br>            context.addTableConfiguration(tableConfiguration);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
<li><p>运行</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainGenerator</span> </span>&#123;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">generator</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">new</span> MybatisGeneratorMain(<span class="hljs-string">"generator.yml"</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/09/2018-06-09-maven%E7%88%B6%E5%AD%90%E6%A8%A1%E5%9D%97jar%E5%8C%85%E7%AE%A1%E7%90%86%E5%92%8Cspring%20boot/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/my-avatar.gif">
      <meta itemprop="name" content="Raven">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="f0.95">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/06/09/2018-06-09-maven%E7%88%B6%E5%AD%90%E6%A8%A1%E5%9D%97jar%E5%8C%85%E7%AE%A1%E7%90%86%E5%92%8Cspring%20boot/" class="post-title-link" itemprop="url">maven父子模块jar包管理和spring boot</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-06-09 11:48:00" itemprop="dateCreated datePublished" datetime="2018-06-09T11:48:00+08:00">2018-06-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-01-19 14:39:48" itemprop="dateModified" datetime="2020-01-19T14:39:48+08:00">2020-01-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%B0%E5%BD%95/" itemprop="url" rel="index"><span itemprop="name">记录</span></a>
                </span>
            </span>

          
            <span id="/2018/06/09/2018-06-09-maven%E7%88%B6%E5%AD%90%E6%A8%A1%E5%9D%97jar%E5%8C%85%E7%AE%A1%E7%90%86%E5%92%8Cspring%20boot/" class="post-meta-item leancloud_visitors" data-flag-title="maven父子模块jar包管理和spring boot" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2018/06/09/2018-06-09-maven%E7%88%B6%E5%AD%90%E6%A8%A1%E5%9D%97jar%E5%8C%85%E7%AE%A1%E7%90%86%E5%92%8Cspring%20boot/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2018/06/09/2018-06-09-maven%E7%88%B6%E5%AD%90%E6%A8%A1%E5%9D%97jar%E5%8C%85%E7%AE%A1%E7%90%86%E5%92%8Cspring%20boot/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs text">parent--父模块空maven项目, 用于管理子模块<br>    controller<br>    service<br>    dao<br>    model<br>    client--被其他项目依赖进行微服务内部调用(因下面问题导致client在其他项目中版本冲突和引入大量无用的jar包)<br></code></pre></td></tr></table></figure>

<h1 id="存在问题"><a href="#存在问题" class="headerlink" title="存在问题"></a>存在问题</h1><ol>
<li>父模块继承spring boot和引入大量jar包, 当项目1引入项目2中的client模块时导致项目2中父模块中很多无用的jar包也引入到项目1中</li>
<li>开始计划是父模块放公用的包和管理子模块的版本, 最后每个人的习惯不一样导致不同项目之间的版本冲突</li>
<li>spring boot继承在maven父子模块中很容易版本冲突</li>
</ol>
<h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><ol>
<li>哪个模块用到什么引入什么, 保持子模块独立</li>
<li>父模块只放&lt;properties&gt;标签管理版本, 不引入任何jar包</li>
<li>父模块不继承spring boot, 由controller层导入spring boot</li>
</ol>
<h1 id="由父模块继承spring-boot改为子模块导入spring-boot"><a href="#由父模块继承spring-boot改为子模块导入spring-boot" class="headerlink" title="由父模块继承spring boot改为子模块导入spring boot"></a>由父模块继承spring boot改为子模块导入spring boot</h1><ol>
<li><p>❌父模块不要这样使用继承</p>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.5.13.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>/&gt;</span> <span class="hljs-comment">&lt;!-- lookup parent from repository --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br></code></pre></td></tr></table></figure>
</li>
<li><p>✔建议这样使用</p>
 <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- 使用dependencyManagement导入版本号 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependencyManagement</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- <br>            自定义版本覆盖spring boot内的版本;<br>            比如验证框架6.0.10.Final覆盖spring boot parent内的5.3.6.Final;<br>            项目会优先获取spring boot内版本, 覆盖可以避免版本冲突<br>            注意: 覆盖版本一定要在spring-boot-dependencies上面<br>        --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.hibernate<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hibernate-validator<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>6.0.10.Final<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!-- 导入spring boot的pom --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.5.13.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">type</span>&gt;</span>pom<span class="hljs-tag">&lt;/<span class="hljs-name">type</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>import<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependencyManagement</span>&gt;</span><br><br>.....<br><br><span class="hljs-comment">&lt;!-- 使用导入, 一定要使用spring-boot-maven插件, 否则无法使用java -jar 命令 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.5.13.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">mainClass</span>&gt;</span>$&#123;start-class&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">mainClass</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">layout</span>&gt;</span>ZIP<span class="hljs-tag">&lt;/<span class="hljs-name">layout</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--&lt;skip&gt;true&lt;/skip&gt;--&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">executions</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">execution</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">goals</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">goal</span>&gt;</span>repackage<span class="hljs-tag">&lt;/<span class="hljs-name">goal</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">goals</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">execution</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">executions</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br></code></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Raven"
      src="/images/my-avatar.gif">
  <p class="site-author-name" itemprop="name">Raven</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">20</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">21</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/winskin" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;winskin" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Raven</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.7.2
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : true,
      notify     : true,
      appId      : 'bif1M0y4qSME95VoykLqQB3n-gzGzoHsz',
      appKey     : 'oMgHevVTvQup0NFhHSPkYLhS',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
